From 2d1aac901a6b848242a4ead7a1eff86ee0d50663 Mon Sep 17 00:00:00 2001
From: Patrick Yavitz <pyavitz@xxxxx.com>
Date: Fri, 9 Feb 2024 07:31:34 -0500
Subject: [PATCH] arch: arm: dts: sun50i-h618-bananapi-m4-zero: fixups and additions

Signed-off-by: Patrick Yavitz <pyavitz@xxxxx.com>
---
 arch/arm/dts/sun50i-h618-bananapi-m4-zero.dts | 2 +-
 configs/bananapi_m4zero_defconfig             | 7 +++++++
 2 files changed, 8 insertions(+), 1 deletion(-)

diff --git a/arch/arm/dts/sun50i-h618-bananapi-m4-zero.dts b/arch/arm/dts/sun50i-h618-bananapi-m4-zero.dts
index 8a9e34bc63..7b5b571bfa 100644
--- a/arch/arm/dts/sun50i-h618-bananapi-m4-zero.dts
+++ b/arch/arm/dts/sun50i-h618-bananapi-m4-zero.dts
@@ -13,7 +13,7 @@
 
 / {
 	model = "Banana Pi M4 Zero";
-	compatible = "sinovoip,bpi-m4-zero", "allwinner,sun50i-h616";
+	compatible = "sinovoip,bpi-m4-zero", "allwinner,sun50i-h618";
 
 	aliases {
 		ethernet0 = &emac0;
diff --git a/configs/bananapi_m4zero_defconfig b/configs/bananapi_m4zero_defconfig
index d067539817..2a5757ae91 100644
--- a/configs/bananapi_m4zero_defconfig
+++ b/configs/bananapi_m4zero_defconfig
@@ -13,6 +13,13 @@ CONFIG_MMC0_CD_PIN="PF6"
 CONFIG_MMC_SUNXI_SLOT_EXTRA=2
 CONFIG_R_I2C_ENABLE=y
 # CONFIG_SYS_MALLOC_CLEAR_ON_INIT is not set
+CONFIG_PREBOOT="usb reset"
 CONFIG_AXP_DCDC3_VOLT=1100
 CONFIG_SPL_I2C_SUPPORT=y
+CONFIG_PHY_SUN4I_USB=y
 CONFIG_AXP313A_POWER=y
+CONFIG_USB_EHCI_HCD=y
+CONFIG_USB_OHCI_HCD=y
+CONFIG_USB_DWC2=y
+CONFIG_USB_GADGET_DWC2_OTG=y
+CONFIG_USB_GADGET_DWC2_OTG_PHY_BUS_WIDTH_8=y
-- 
2.39.2

